/* Fast and Fine Technical Services FZE - Generated by build script */
!function(){"use strict";const e={theme:localStorage.getItem("theme")||"light",language:document.documentElement.lang||"en",mobileMenuOpen:!1,scrolled:!1},t={header:document.getElementById("header"),mobileMenuToggle:document.getElementById("mobileMenuToggle"),mobileMenuClose:document.getElementById("mobileMenuClose"),mobileMenuOverlay:document.getElementById("mobileMenuOverlay"),themeToggle:document.getElementById("themeToggle"),langBtn:document.getElementById("langBtn"),langDropdown:document.getElementById("langDropdown"),scrollProgress:document.getElementById("scrollProgress"),backToTop:document.getElementById("backToTop"),navLinks:document.querySelectorAll(".nav-link, .mobile-nav-link"),body:document.body};function n(){e.theme="light"===e.theme?"dark":"light",document.body.setAttribute("data-theme",e.theme),localStorage.setItem("theme",e.theme),m("theme_changed",{theme:e.theme})}function o(){e.mobileMenuOpen=!e.mobileMenuOpen,e.mobileMenuOpen?r():i()}function r(){t.mobileMenuOverlay.classList.add("active"),t.body.style.overflow="hidden",m("mobile_menu_opened")}function i(){e.mobileMenuOpen=!1,t.mobileMenuOverlay.classList.remove("active"),t.body.style.overflow="",m("mobile_menu_closed")}function a(){const n=window.pageYOffset||document.documentElement.scrollTop,o=n/(document.documentElement.scrollHeight-window.innerHeight)*100;t.scrollProgress&&(t.scrollProgress.style.width=o+"%"),n>50&&!e.scrolled?(e.scrolled=!0,t.header?.classList.add("scrolled")):n<=50&&e.scrolled&&(e.scrolled=!1,t.header?.classList.remove("scrolled")),t.backToTop&&(n>300?t.backToTop.classList.add("visible"):t.backToTop.classList.remove("visible")),function(){const e=document.querySelectorAll("section[id]"),n=window.pageYOffset+200;e.forEach(e=>{const o=e.offsetTop,r=e.offsetHeight,i=e.getAttribute("id");n>=o&&n<o+r&&t.navLinks.forEach(e=>{e.getAttribute("data-section")===i?e.classList.add("active"):e.classList.remove("active")})})}()}async function s(e){e.preventDefault();const t=e.target,n=new FormData(t),o=t.querySelector('button[type="submit"]');try{o.disabled=!0,o.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> <span>Subscribing...</span>';const e=await fetch("/handlers/newsletter.php",{method:"POST",body:n}),r=await e.json();r.success?(d("success",r.message||"Successfully subscribed!"),t.reset(),m("newsletter_subscribed",{email:n.get("email")})):d("error",r.message||"Subscription failed")}catch(e){console.error("Newsletter error:",e),d("error","An error occurred. Please try again.")}finally{o.disabled=!1,o.innerHTML='<i class="fa-solid fa-paper-plane"></i> <span>Subscribe</span>'}}async function c(e){e.preventDefault();const t=e.target,n=new FormData(t),o=t.querySelector('button[type="submit"]');try{o.disabled=!0,o.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> Sending...';const e=await fetch("/handlers/contact-form.php",{method:"POST",body:n}),r=await e.json();r.success?(d("success",r.message||"Message sent successfully!"),t.reset(),m("contact_form_submitted")):d("error",r.message||"Failed to send message")}catch(e){console.error("Contact form error:",e),d("error","An error occurred. Please try again.")}finally{o.disabled=!1,o.innerHTML='<i class="fa-solid fa-paper-plane"></i> Send Message'}}async function l(e){e.preventDefault();const t=e.target,n=new FormData(t),o=t.querySelector('button[type="submit"]');try{o.disabled=!0,o.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> Creating Booking...';const e=await fetch("/handlers/booking-handler.php",{method:"POST",body:n}),r=await e.json();r.success?(d("success",r.message||"Booking created successfully!"),t.reset(),m("booking_created",{bookingId:r.data?.booking_id}),r.data?.booking_id&&setTimeout(()=>{window.location.href=`/booking-confirmation.php?id=${r.data.booking_id}`},2e3)):d("error",r.message||"Failed to create booking")}catch(e){console.error("Booking error:",e),d("error","An error occurred. Please try again.")}finally{o.disabled=!1,o.innerHTML='<i class="fa-solid fa-calendar-check"></i> Book Now'}}function d(e,t,n=5e3){const o=document.querySelector(".notification");o&&o.remove();const r=document.createElement("div");r.className=`notification notification-${e}`;const i="success"===e?"fa-check-circle":"error"===e?"fa-exclamation-circle":"fa-info-circle";r.innerHTML=`\n            <i class="fa-solid ${i}"></i>\n            <span>${t}</span>\n            <button class="notification-close">\n                <i class="fa-solid fa-times"></i>\n            </button>\n        `,document.body.appendChild(r),setTimeout(()=>r.classList.add("show"),100);const a=setTimeout(()=>u(r),n);r.querySelector(".notification-close").addEventListener("click",()=>{clearTimeout(a),u(r)})}function u(e){e.classList.remove("show"),setTimeout(()=>e.remove(),300)}function m(e,t={}){"undefined"!=typeof fetch&&fetch("/api/track-event.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_type:e,details:t,timestamp:(new Date).toISOString()})}).catch(e=>console.error("Analytics error:",e)),"undefined"!=typeof gtag&&gtag("event",e,t)}function g(){document.body.setAttribute("data-theme",e.theme),t.themeToggle&&t.themeToggle.addEventListener("click",n),t.mobileMenuToggle&&t.mobileMenuToggle.addEventListener("click",o),t.mobileMenuClose&&t.mobileMenuClose.addEventListener("click",i),t.mobileMenuOverlay&&t.mobileMenuOverlay.addEventListener("click",function(e){e.target===t.mobileMenuOverlay&&i()}),document.querySelectorAll(".mobile-nav-link").forEach(e=>{e.addEventListener("click",i)}),t.navLinks.forEach(e=>{e.addEventListener("click",function(e){const n=this.getAttribute("href");if(n&&n.startsWith("#")){e.preventDefault();const o=n.substring(1),r=document.getElementById(o);if(r){const e=t.header?t.header.offsetHeight:80,n=r.offsetTop-e;window.scrollTo({top:n,behavior:"smooth"}),function(e){t.navLinks.forEach(e=>e.classList.remove("active")),e.classList.add("active");const n=e.getAttribute("data-section");n&&document.querySelectorAll(`[data-section="${n}"]`).forEach(e=>{e.classList.add("active")})}(this),m("navigation_click",{target:o})}}})}),function(){let e=!1;window.addEventListener("scroll",function(){e||(window.requestAnimationFrame(function(){a(),e=!1}),e=!0)}),a()}(),t.backToTop&&t.backToTop.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"}),m("back_to_top_clicked")}),function(){const e=document.querySelectorAll(".scroll-reveal, .scroll-reveal-left, .scroll-reveal-right, .scroll-reveal-scale"),t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&e.target.classList.add("revealed")})},{threshold:.15,rootMargin:"0px 0px -100px 0px"});e.forEach(e=>t.observe(e))}(),function(){const e=document.getElementById("newsletterForm");e&&e.addEventListener("submit",s);const t=document.getElementById("contactForm");t&&t.addEventListener("submit",c);const n=document.getElementById("bookingForm");n&&n.addEventListener("submit",l)}(),function(){const e=document.querySelectorAll("img[data-src], iframe[data-src]");if("IntersectionObserver"in window){const t=new IntersectionObserver(function(e){e.forEach(e=>{if(e.isIntersecting){const n=e.target,o=n.getAttribute("data-src");o&&(n.src=o,n.removeAttribute("data-src"),n.classList.add("loaded")),t.unobserve(n)}})});e.forEach(e=>t.observe(e))}else e.forEach(e=>{const t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"))})}(),function(){const e=document.querySelectorAll("[data-count]");if(0===e.length)return;const t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(function(e){const t=parseInt(e.getAttribute("data-count")),n=t/125;let o=0;const r=setInterval(()=>{o+=n,o>=t?(e.textContent=t.toLocaleString(),clearInterval(r)):e.textContent=Math.floor(o).toLocaleString()},16)}(e.target),t.unobserve(e.target))})},{threshold:.5});e.forEach(e=>t.observe(e))}(),function(){let e=Date.now();document.addEventListener("visibilitychange",function(){if(document.hidden){const t=Date.now()-e;m("page_hidden",{time_spent:Math.round(t/1e3)})}else e=Date.now(),m("page_visible")})}(),m("page_loaded",{page:window.location.pathname,referrer:document.referrer})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g(),window.FastAndFine={trackEvent:m,showNotification:d,toggleTheme:n,openMobileMenu:r,closeMobileMenu:i}}(),function(){"use strict";const e={currentCategory:"all",searchQuery:"",servicesData:[],currentLanguage:document.documentElement.lang||"en"},t={servicesGrid:document.getElementById("servicesGrid"),filterBtns:document.querySelectorAll(".filter-btn"),searchInput:document.getElementById("serviceSearchInput"),searchClearBtn:document.getElementById("searchClearBtn"),noResults:document.getElementById("noResults"),resetSearchBtn:document.getElementById("resetSearchBtn"),serviceModal:document.getElementById("serviceModal"),serviceModalOverlay:document.getElementById("serviceModalOverlay"),serviceModalClose:document.getElementById("serviceModalClose"),serviceModalBody:document.getElementById("serviceModalBody"),serviceModalTitle:document.getElementById("serviceModalTitle"),viewDetailsBtns:document.querySelectorAll(".view-details-btn")};function n(){!function(){const t=document.getElementById("servicesData");if(t)try{e.servicesData=JSON.parse(t.textContent)}catch(e){console.error("Error parsing services data:",e)}}(),t.filterBtns.forEach(e=>{e.addEventListener("click",r)}),t.searchInput&&(t.searchInput.addEventListener("input",function(e){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),e.apply(this,n)},300)}}(i)),t.searchInput.addEventListener("keyup",function(e){"Escape"===e.key&&a()})),t.searchClearBtn&&t.searchClearBtn.addEventListener("click",a),t.resetSearchBtn&&t.resetSearchBtn.addEventListener("click",s),t.viewDetailsBtns.forEach(e=>{e.addEventListener("click",function(){l(this.getAttribute("data-service-id"))})}),document.querySelectorAll(".view-details-btn").forEach(e=>{e.removeEventListener("click",o),e.addEventListener("click",o)}),t.serviceModalClose&&t.serviceModalClose.addEventListener("click",d),t.serviceModalOverlay&&t.serviceModalOverlay.addEventListener("click",d),document.addEventListener("keydown",function(e){"Escape"===e.key&&t.serviceModal&&t.serviceModal.classList.contains("active")&&d()}),document.querySelectorAll(".service-flip-card").forEach(e=>{e.addEventListener("touchstart",function(e){e.target.closest(".view-details-btn")||e.target.closest(".btn")||this.classList.toggle("flipped")}),e.setAttribute("tabindex","0"),e.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.classList.toggle("flipped"))})})}function o(e){e.preventDefault(),e.stopPropagation(),l(this.getAttribute("data-service-id"))}function r(n){const o=this.getAttribute("data-category");e.currentCategory=o,t.filterBtns.forEach(e=>e.classList.remove("active")),this.classList.add("active"),c(),"function"==typeof trackEvent&&trackEvent("service_filter",{category:o})}function i(n){e.searchQuery=n.target.value.toLowerCase().trim(),t.searchClearBtn&&(t.searchClearBtn.style.display=e.searchQuery?"flex":"none"),c(),"function"==typeof trackEvent&&e.searchQuery&&trackEvent("service_search",{query:e.searchQuery})}function a(){t.searchInput&&(t.searchInput.value="",e.searchQuery=""),t.searchClearBtn&&(t.searchClearBtn.style.display="none"),c()}function s(){e.currentCategory="all",e.searchQuery="",t.filterBtns.forEach(e=>e.classList.remove("active"));const n=document.querySelector('.filter-btn[data-category="all"]');n&&n.classList.add("active"),t.searchInput&&(t.searchInput.value=""),t.searchClearBtn&&(t.searchClearBtn.style.display="none"),c()}function c(){const n=document.querySelectorAll(".service-flip-card");let o=0;n.forEach(t=>{const n=t.getAttribute("data-category"),r=t.getAttribute("data-service-name").toLowerCase(),i="all"===e.currentCategory||n===e.currentCategory,a=!e.searchQuery||r.includes(e.searchQuery);i&&a?(t.style.display="block",t.classList.remove("flipped"),setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},50*o),o++):(t.style.display="none",t.style.opacity="0",t.style.transform="translateY(20px)")}),t.noResults&&(0===o?(t.noResults.style.display="flex",t.servicesGrid.style.display="none"):(t.noResults.style.display="none",t.servicesGrid.style.display="grid"))}function l(n){const o=e.servicesData.find(e=>e.id==n);if(!o)return void console.error("Service not found:",n);const r="ar"===e.currentLanguage?o.name_ar:o.name_en,i="ar"===e.currentLanguage?o.long_desc_ar:o.long_desc_en,a="ar"===e.currentLanguage?o.features_ar:o.features_en,s=`\n            <div class="service-detail">\n                <div class="service-detail-header">\n                    <div class="service-icon-modal">\n                        <i class="${u(o.icon_class)}"></i>\n                    </div>\n                    <div class="service-detail-title">\n                        <h2>${u(r)}</h2>\n                        <span class="category-badge badge-${u(o.category)}">\n                            ${u(o.category)}\n                        </span>\n                    </div>\n                </div>\n\n                <div class="service-detail-body">\n                    <div class="service-description">\n                        <h4><i class="fa-solid fa-info-circle"></i> ${m("description")}</h4>\n                        <p>${u(i)}</p>\n                    </div>\n\n                    ${a&&a.length>0?`\n                        <div class="service-features-full">\n                            <h4><i class="fa-solid fa-list-check"></i> ${m("features_included")}</h4>\n                            <ul class="features-grid">\n                                ${a.map(e=>`\n                                    <li>\n                                        <i class="fa-solid fa-check-circle"></i>\n                                        <span>${u(e)}</span>\n                                    </li>\n                                `).join("")}\n                            </ul>\n                        </div>\n                    `:""}\n\n                    <div class="service-pricing">\n                        <h4><i class="fa-solid fa-dollar-sign"></i> ${m("pricing")}</h4>\n                        <div class="price-info">\n                            <span class="price-label">${m("starting_from")}:</span>\n                            <span class="price-value">${c=o.starting_price,new Intl.NumberFormat("en-AE",{style:"currency",currency:"AED",minimumFractionDigits:0}).format(c)}</span>\n                            <p class="price-note">${m("price_varies_note")}</p>\n                        </div>\n                    </div>\n\n                    <div class="service-cta-box">\n                        <i class="fa-solid fa-headset"></i>\n                        <div class="cta-box-content">\n                            <h4>${m("ready_to_book")}</h4>\n                            <p>${m("ready_to_book_desc")}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;var c;t.serviceModalTitle&&(t.serviceModalTitle.textContent=r),t.serviceModalBody&&(t.serviceModalBody.innerHTML=s);const l=document.getElementById("modalBookNowBtn"),d=document.getElementById("modalGetQuoteBtn");l&&(l.href=`#booking?service=${n}`),d&&(d.href=`#quote?service=${n}`),t.serviceModal&&(t.serviceModal.classList.add("active"),document.body.style.overflow="hidden","function"==typeof trackEvent&&trackEvent("service_detail_view",{service_id:n,service_name:r}))}function d(){t.serviceModal&&(t.serviceModal.classList.remove("active"),document.body.style.overflow="")}function u(e){const t=document.createElement("div");return t.textContent=e||"",t.innerHTML}function m(t){return{description:"ar"===e.currentLanguage?"الوصف":"Description",features_included:"ar"===e.currentLanguage?"المميزات المتضمنة":"Features Included",pricing:"ar"===e.currentLanguage?"التسعير":"Pricing",starting_from:"ar"===e.currentLanguage?"تبدأ من":"Starting from",price_varies_note:"ar"===e.currentLanguage?"قد تختلف الأسعار حسب حجم المشروع ومتطلباته":"Prices may vary based on project size and requirements",ready_to_book:"ar"===e.currentLanguage?"هل أنت مستعد للحجز؟":"Ready to Book?",ready_to_book_desc:"ar"===e.currentLanguage?"فريقنا متاح على مدار الساعة لمساعدتك":"Our team is available 24/7 to assist you"}[t]||t}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.ServicesModule={openServiceModal:l,closeServiceModal:d,filterServices:c,resetFilters:s}}(),function(){"use strict";const e={currentCategory:"all",currentView:"masonry",visibleItems:9,itemsPerPage:6,portfolioData:[],currentLanguage:document.documentElement.lang||"en",lightboxImages:[],lightboxCurrentIndex:0,beforeAfterDragging:!1},t={portfolioGrid:document.getElementById("portfolioGrid"),filterBtns:document.querySelectorAll(".portfolio-filter .filter-btn"),viewBtns:document.querySelectorAll(".view-toggle .view-btn"),noResults:document.getElementById("noPortfolioResults"),resetBtn:document.getElementById("resetPortfolioBtn"),loadMoreBtn:document.getElementById("loadMoreBtn"),loadMoreContainer:document.getElementById("loadMoreContainer"),projectModal:document.getElementById("projectModal"),projectModalOverlay:document.getElementById("projectModalOverlay"),projectModalClose:document.getElementById("projectModalClose"),projectModalBody:document.getElementById("projectModalBody"),projectModalTitle:document.getElementById("projectModalTitle"),lightbox:document.getElementById("galleryLightbox"),lightboxOverlay:document.getElementById("lightboxOverlay"),lightboxClose:document.getElementById("lightboxClose"),lightboxImage:document.getElementById("lightboxImage"),lightboxContent:document.getElementById("lightboxContent"),lightboxCaption:document.getElementById("lightboxCaption"),lightboxPrev:document.getElementById("lightboxPrev"),lightboxNext:document.getElementById("lightboxNext"),lightboxCurrentIndex:document.getElementById("lightboxCurrentIndex"),lightboxTotalCount:document.getElementById("lightboxTotalCount"),beforeAfterModal:document.getElementById("beforeAfterModal"),beforeAfterOverlay:document.getElementById("beforeAfterOverlay"),beforeAfterClose:document.getElementById("beforeAfterClose"),beforeAfterSlider:document.getElementById("beforeAfterSlider"),beforeImage:document.getElementById("beforeImage"),afterImage:document.getElementById("afterImage"),sliderHandle:document.getElementById("sliderHandle")};function n(){!function(){const t=document.getElementById("portfolioData");if(t)try{e.portfolioData=JSON.parse(t.textContent)}catch(e){console.error("Error parsing portfolio data:",e)}}(),function(){let n;t.filterBtns.forEach(e=>{e.addEventListener("click",r)}),t.viewBtns.forEach(e=>{e.addEventListener("click",i)}),t.resetBtn&&t.resetBtn.addEventListener("click",c),t.loadMoreBtn&&t.loadMoreBtn.addEventListener("click",s),o(),t.projectModalClose&&t.projectModalClose.addEventListener("click",p),t.projectModalOverlay&&t.projectModalOverlay.addEventListener("click",p),t.lightboxClose&&t.lightboxClose.addEventListener("click",h),t.lightboxOverlay&&t.lightboxOverlay.addEventListener("click",h),t.lightboxPrev&&t.lightboxPrev.addEventListener("click",()=>y(-1)),t.lightboxNext&&t.lightboxNext.addEventListener("click",()=>y(1)),t.beforeAfterClose&&t.beforeAfterClose.addEventListener("click",E),t.beforeAfterOverlay&&t.beforeAfterOverlay.addEventListener("click",E),t.sliderHandle&&function(){if(!t.beforeAfterSlider||!t.sliderHandle)return;const e=t.beforeAfterSlider,n=t.sliderHandle;n.addEventListener("mousedown",L),document.addEventListener("mousemove",k),document.addEventListener("mouseup",B),n.addEventListener("touchstart",L),document.addEventListener("touchmove",k),document.addEventListener("touchend",B),e.addEventListener("click",t=>{if(t.target!==n&&!n.contains(t.target)){const n=e.getBoundingClientRect();I((t.clientX-n.left)/n.width*100)}})}(),document.addEventListener("keydown",w),window.addEventListener("resize",()=>{clearTimeout(n),n=setTimeout(()=>{"masonry"===e.currentView&&l()},250)})}(),l(),a()}function o(){document.querySelectorAll(".view-details-btn").forEach(e=>{e.removeEventListener("click",d),e.addEventListener("click",d)}),document.querySelectorAll(".view-gallery-btn").forEach(e=>{e.removeEventListener("click",u),e.addEventListener("click",u)}),document.querySelectorAll(".view-before-after-btn").forEach(e=>{e.removeEventListener("click",m),e.addEventListener("click",m)})}function r(n){const o=this.getAttribute("data-category");e.currentCategory=o,e.visibleItems=9,t.filterBtns.forEach(e=>e.classList.remove("active")),this.classList.add("active"),a(),"function"==typeof trackEvent&&trackEvent("portfolio_filter",{category:o})}function i(n){const o=this.getAttribute("data-view");e.currentView=o,t.viewBtns.forEach(e=>e.classList.remove("active")),this.classList.add("active"),t.portfolioGrid&&("masonry"===o?(t.portfolioGrid.classList.add("masonry-grid"),t.portfolioGrid.classList.remove("standard-grid"),setTimeout(()=>l(),100)):(t.portfolioGrid.classList.remove("masonry-grid"),t.portfolioGrid.classList.add("standard-grid")))}function a(){const n=document.querySelectorAll(".portfolio-item");let r=0,i=0;var a;n.forEach((t,n)=>{const o=t.getAttribute("data-category");"all"===e.currentCategory||o===e.currentCategory?(r++,r<=e.visibleItems?(t.style.display="block",setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},50*i),i++):t.style.display="none"):(t.style.display="none",t.style.opacity="0",t.style.transform="translateY(20px)")}),t.noResults&&(0===r?(t.noResults.style.display="flex",t.portfolioGrid&&(t.portfolioGrid.style.display="none"),t.loadMoreContainer&&(t.loadMoreContainer.style.display="none")):(t.noResults.style.display="none",t.portfolioGrid&&(t.portfolioGrid.style.display="grid"))),a=r,t.loadMoreContainer&&(a>e.visibleItems?t.loadMoreContainer.style.display="flex":t.loadMoreContainer.style.display="none"),"masonry"===e.currentView&&setTimeout(()=>l(),100),o()}function s(){e.visibleItems+=e.itemsPerPage,a(),"function"==typeof trackEvent&&trackEvent("portfolio_load_more",{items:e.visibleItems})}function c(){e.currentCategory="all",e.visibleItems=9,t.filterBtns.forEach(e=>e.classList.remove("active"));const n=document.querySelector('.portfolio-filter .filter-btn[data-category="all"]');n&&n.classList.add("active"),a()}function l(){if(!t.portfolioGrid||!t.portfolioGrid.classList.contains("masonry-grid"))return;const e=Array.from(t.portfolioGrid.querySelectorAll('.portfolio-item:not([style*="display: none"])')),n=function(){const e=window.innerWidth;return e>=1024?3:e>=768?2:1}(),o=Array(n).fill(0),r=(t.portfolioGrid.offsetWidth-30*(n-1))/n;e.forEach(e=>{const t=o.indexOf(Math.min(...o)),n=t*(r+30),i=o[t];e.style.position="absolute",e.style.left=`${n}px`,e.style.top=`${i}px`,e.style.width=`${r}px`,o[t]+=e.offsetHeight+30});const i=Math.max(...o);t.portfolioGrid.style.height=`${i}px`,t.portfolioGrid.style.position="relative"}function d(e){e.preventDefault(),e.stopPropagation(),g(this.getAttribute("data-project-id"))}function u(e){e.preventDefault(),e.stopPropagation(),f(this.getAttribute("data-project-id"))}function m(e){e.preventDefault(),e.stopPropagation(),b(this.getAttribute("data-project-id"))}function g(n){const o=e.portfolioData.find(e=>e.id==n);if(!o)return void console.error("Project not found:",n);const r="ar"===e.currentLanguage?o.title_ar:o.title_en,i="ar"===e.currentLanguage?o.description_ar:o.description_en,a="ar"===e.currentLanguage?o.service_name_ar:o.service_name_en,s=`\n            <div class="project-detail">\n                <div class="project-detail-header">\n                    <img src="${x(o.main_image)}" alt="${x(r)}" class="project-main-image">\n                </div>\n\n                <div class="project-detail-body">\n                    <div class="project-meta-grid">\n                        <div class="meta-item">\n                            <i class="${x(o.icon_class)}"></i>\n                            <div>\n                                <span class="meta-label">${_("service")}</span>\n                                <span class="meta-value">${x(a)}</span>\n                            </div>\n                        </div>\n                        <div class="meta-item">\n                            <i class="fa-solid fa-map-marker-alt"></i>\n                            <div>\n                                <span class="meta-label">${_("location")}</span>\n                                <span class="meta-value">${x(o.location)}</span>\n                            </div>\n                        </div>\n                        <div class="meta-item">\n                            <i class="fa-regular fa-calendar"></i>\n                            <div>\n                                <span class="meta-label">${_("completed")}</span>\n                                <span class="meta-value">${c=o.completion_date,new Date(c).toLocaleDateString("ar"===e.currentLanguage?"ar-AE":"en-US",{year:"numeric",month:"short"})}</span>\n                            </div>\n                        </div>\n                        ${o.project_duration?`\n                            <div class="meta-item">\n                                <i class="fa-solid fa-clock"></i>\n                                <div>\n                                    <span class="meta-label">${_("duration")}</span>\n                                    <span class="meta-value">${x(o.project_duration)}</span>\n                                </div>\n                            </div>\n                        `:""}\n                    </div>\n\n                    <div class="project-description">\n                        <h4><i class="fa-solid fa-info-circle"></i> ${_("project_description")}</h4>\n                        <p>${x(i)}</p>\n                    </div>\n\n                    ${o.gallery_images&&o.gallery_images.length>0?`\n                        <div class="project-gallery-preview">\n                            <h4><i class="fa-solid fa-images"></i> ${_("project_gallery")}</h4>\n                            <div class="gallery-grid">\n                                ${o.gallery_images.slice(0,4).map((e,t)=>`\n                                    <img src="${x(e)}" alt="${x(r)} - ${t+1}"\n                                         class="gallery-thumb" data-index="${t}">\n                                `).join("")}\n                                ${o.gallery_images.length>4?`\n                                    <div class="gallery-more">\n                                        <span>+${o.gallery_images.length-4} more</span>\n                                    </div>\n                                `:""}\n                            </div>\n                            <button class="btn btn-outline view-all-photos-btn" data-project-id="${o.id}">\n                                <i class="fa-solid fa-expand"></i>\n                                <span>${_("view_all_photos")}</span>\n                            </button>\n                        </div>\n                    `:""}\n\n                    <div class="project-cta">\n                        <p>${_("interested_similar_project")}</p>\n                        <div class="cta-buttons">\n                            <a href="#booking" class="btn btn-primary">\n                                <i class="fa-solid fa-calendar-check"></i>\n                                <span>${_("book_now")}</span>\n                            </a>\n                            <a href="#quote" class="btn btn-outline">\n                                <i class="fa-solid fa-calculator"></i>\n                                <span>${_("get_quote")}</span>\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;var c;if(t.projectModalTitle&&(t.projectModalTitle.textContent=r),t.projectModalBody){t.projectModalBody.innerHTML=s,t.projectModalBody.querySelectorAll(".gallery-thumb").forEach(e=>{e.addEventListener("click",()=>{const t=parseInt(e.getAttribute("data-index"));f(n,t)})});const e=t.projectModalBody.querySelector(".view-all-photos-btn");e&&e.addEventListener("click",()=>f(n))}t.projectModal&&(t.projectModal.classList.add("active"),document.body.style.overflow="hidden","function"==typeof trackEvent&&trackEvent("project_detail_view",{project_id:n,project_title:r}))}function p(){t.projectModal&&(t.projectModal.classList.remove("active"),document.body.style.overflow="")}function f(n,o=0){const r=e.portfolioData.find(e=>e.id==n);r&&r.gallery_images&&0!==r.gallery_images.length?(e.lightboxImages=r.gallery_images,e.lightboxCurrentIndex=o,v(),t.lightbox&&(t.lightbox.classList.add("active"),document.body.style.overflow="hidden"),"function"==typeof trackEvent&&trackEvent("gallery_view",{project_id:n})):console.error("No gallery images found for project:",n)}function v(){if(!e.lightboxImages||0===e.lightboxImages.length)return;const n=e.lightboxImages[e.lightboxCurrentIndex];t.lightboxImage&&(t.lightboxImage.src=n,t.lightboxImage.alt=`Image ${e.lightboxCurrentIndex+1}`),t.lightboxCurrentIndex&&(t.lightboxCurrentIndex.textContent=e.lightboxCurrentIndex+1),t.lightboxTotalCount&&(t.lightboxTotalCount.textContent=e.lightboxImages.length),t.lightboxPrev&&(t.lightboxPrev.style.display=e.lightboxCurrentIndex>0?"flex":"none"),t.lightboxNext&&(t.lightboxNext.style.display=e.lightboxCurrentIndex<e.lightboxImages.length-1?"flex":"none")}function y(t){const n=e.lightboxCurrentIndex+t;n>=0&&n<e.lightboxImages.length&&(e.lightboxCurrentIndex=n,v())}function h(){t.lightbox&&(t.lightbox.classList.remove("active"),document.body.style.overflow=""),e.lightboxImages=[],e.lightboxCurrentIndex=0}function b(n){const o=e.portfolioData.find(e=>e.id==n);o&&o.before_image&&o.after_image?(t.beforeImage&&(t.beforeImage.src=o.before_image),t.afterImage&&(t.afterImage.src=o.after_image),t.beforeAfterModal&&(t.beforeAfterModal.classList.add("active"),document.body.style.overflow="hidden",setTimeout(()=>{I(50)},100)),"function"==typeof trackEvent&&trackEvent("before_after_view",{project_id:n})):console.error("Before/after images not found for project:",n)}function E(){t.beforeAfterModal&&(t.beforeAfterModal.classList.remove("active"),document.body.style.overflow="")}function L(t){t.preventDefault(),e.beforeAfterDragging=!0}function k(n){if(!e.beforeAfterDragging)return;const o=t.beforeAfterSlider;if(!o)return;const r=o.getBoundingClientRect(),i=(n.clientX||n.touches[0].clientX)-r.left;I(Math.max(0,Math.min(100,i/r.width*100)))}function B(){e.beforeAfterDragging=!1}function I(e){if(!t.sliderHandle||!t.beforeAfterSlider)return;const n=t.beforeAfterSlider.querySelector(".after-image-container");n&&(n.style.clipPath=`inset(0 ${100-e}% 0 0)`),t.sliderHandle.style.left=`${e}%`}function w(e){t.lightbox&&t.lightbox.classList.contains("active")&&("Escape"===e.key?h():"ArrowLeft"===e.key?y(-1):"ArrowRight"===e.key&&y(1)),t.projectModal&&t.projectModal.classList.contains("active")&&"Escape"===e.key&&p(),t.beforeAfterModal&&t.beforeAfterModal.classList.contains("active")&&"Escape"===e.key&&E()}function x(e){const t=document.createElement("div");return t.textContent=e||"",t.innerHTML}function _(t){return{service:"ar"===e.currentLanguage?"الخدمة":"Service",location:"ar"===e.currentLanguage?"الموقع":"Location",completed:"ar"===e.currentLanguage?"تم الإنجاز":"Completed",duration:"ar"===e.currentLanguage?"المدة":"Duration",project_description:"ar"===e.currentLanguage?"وصف المشروع":"Project Description",project_gallery:"ar"===e.currentLanguage?"معرض المشروع":"Project Gallery",view_all_photos:"ar"===e.currentLanguage?"عرض جميع الصور":"View All Photos",interested_similar_project:"ar"===e.currentLanguage?"مهتم بمشروع مماثل؟":"Interested in a similar project?",book_now:"ar"===e.currentLanguage?"احجز الآن":"Book Now",get_quote:"ar"===e.currentLanguage?"احصل على عرض سعر":"Get Quote"}[t]||t}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.PortfolioModule={openProjectModal:g,closeProjectModal:p,openGalleryLightbox:f,closeLightbox:h,openBeforeAfterModal:b,closeBeforeAfterModal:E,filterProjects:a,resetFilters:c}}(),function(){"use strict";const e={currentIndex:0,testimonialsData:[],autoplayInterval:null,autoplayDelay:5e3,isAutoplayActive:!0,slidesPerView:3,slideGap:30,isDragging:!1,startPos:0,currentTranslate:0,prevTranslate:0,animationID:0},t={carousel:document.getElementById("testimonialsCarousel"),track:document.getElementById("carouselTrack"),prevBtn:document.getElementById("testimonialsPrev"),nextBtn:document.getElementById("testimonialsNext"),indicators:document.getElementById("carouselIndicators"),autoplayToggle:document.getElementById("autoplayToggle"),cards:null};function n(){t.carousel&&t.track&&(function(){const t=document.getElementById("testimonialsData");if(t)try{e.testimonialsData=JSON.parse(t.textContent)}catch(e){console.error("Error parsing testimonials data:",e)}}(),o(),t.cards=Array.from(t.track.querySelectorAll(".testimonial-card")),0!==t.cards.length&&(r(),function(){let e;t.prevBtn&&t.prevBtn.addEventListener("click",i),t.nextBtn&&t.nextBtn.addEventListener("click",a),t.autoplayToggle&&t.autoplayToggle.addEventListener("click",E),t.carousel&&(t.carousel.addEventListener("mouseenter",y),t.carousel.addEventListener("mouseleave",h)),t.track&&(t.track.addEventListener("touchstart",l),t.track.addEventListener("touchmove",d),t.track.addEventListener("touchend",u),t.track.addEventListener("mousedown",l),t.track.addEventListener("mousemove",d),t.track.addEventListener("mouseup",u),t.track.addEventListener("mouseleave",u),t.track.addEventListener("contextmenu",e=>e.preventDefault())),document.addEventListener("keydown",p),window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{o(),r(),c()},250)})}(),c(),f()))}function o(){const t=window.innerWidth;e.slidesPerView=t>=1024?3:t>=768?2:1}function r(){if(!t.indicators)return;const n=t.cards.length,o=Math.ceil(n/e.slidesPerView);t.indicators.innerHTML="";for(let n=0;n<o;n++){const o=document.createElement("button");o.className="indicator-dot",o.setAttribute("aria-label",`Go to slide ${n+1}`),o.addEventListener("click",()=>s(n*e.slidesPerView)),t.indicators.appendChild(o)}}function i(){e.currentIndex=Math.max(0,e.currentIndex-e.slidesPerView),c(),b(),"function"==typeof trackEvent&&trackEvent("testimonials_nav",{direction:"previous"})}function a(){const n=t.cards.length-e.slidesPerView;e.currentIndex=Math.min(n,e.currentIndex+e.slidesPerView),e.currentIndex>=n&&(e.currentIndex=0),c(),b(),"function"==typeof trackEvent&&trackEvent("testimonials_nav",{direction:"next"})}function s(n){e.currentIndex=Math.max(0,Math.min(n,t.cards.length-e.slidesPerView)),c(),b()}function c(){if(!t.track||0===t.cards.length)return;const n=t.cards[0].offsetWidth,o=-e.currentIndex*(n+e.slideGap);t.track.style.transform=`translateX(${o}px)`,e.currentTranslate=o,e.prevTranslate=o,function(){if(!t.indicators)return;const n=t.indicators.querySelectorAll(".indicator-dot"),o=Math.floor(e.currentIndex/e.slidesPerView);n.forEach((e,t)=>{t===o?e.classList.add("active"):e.classList.remove("active")})}(),function(){if(t.prevBtn&&(0===e.currentIndex?(t.prevBtn.disabled=!0,t.prevBtn.style.opacity="0.5"):(t.prevBtn.disabled=!1,t.prevBtn.style.opacity="1")),t.nextBtn){const n=t.cards.length-e.slidesPerView;e.currentIndex>=n?t.nextBtn.style.opacity="0.5":t.nextBtn.style.opacity="1"}}()}function l(n){"mousedown"===n.type&&n.preventDefault(),e.isDragging=!0,e.startPos=m(n),e.animationID=requestAnimationFrame(g),t.track.style.cursor="grabbing"}function d(t){if(!e.isDragging)return;const n=m(t)-e.startPos;e.currentTranslate=e.prevTranslate+n}function u(){if(!e.isDragging)return;e.isDragging=!1,cancelAnimationFrame(e.animationID);const n=e.currentTranslate-e.prevTranslate;n<-100&&e.currentIndex<t.cards.length-e.slidesPerView?a():n>100&&e.currentIndex>0?i():c(),t.track.style.cursor="grab"}function m(e){return e.type.includes("mouse")?e.pageX:e.touches[0].clientX}function g(){e.isDragging&&(t.track.style.transform=`translateX(${e.currentTranslate}px)`,requestAnimationFrame(g))}function p(e){t.carousel&&function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(t.carousel)&&("ArrowLeft"===e.key?i():"ArrowRight"===e.key&&a())}function f(){e.isAutoplayActive&&(e.autoplayInterval=setInterval(()=>{a()},e.autoplayDelay))}function v(){e.autoplayInterval&&(clearInterval(e.autoplayInterval),e.autoplayInterval=null)}function y(){v()}function h(){e.isAutoplayActive&&f()}function b(){v(),e.isAutoplayActive&&f()}function E(){e.isAutoplayActive=!e.isAutoplayActive,e.isAutoplayActive?(f(),t.autoplayToggle&&(t.autoplayToggle.innerHTML='<i class="fa-solid fa-pause"></i>')):(v(),t.autoplayToggle&&(t.autoplayToggle.innerHTML='<i class="fa-solid fa-play"></i>')),"function"==typeof trackEvent&&trackEvent("testimonials_autoplay",{active:e.isAutoplayActive})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.TestimonialsModule={nextSlide:a,prevSlide:i,goToSlide:s,toggleAutoplay:E,pauseAutoplay:y,resumeAutoplay:h}}(),function(){"use strict";const e={currentStep:1,totalSteps:6,servicesData:[],formData:{},pricing:{basePrice:0,hourlyRate:0,duration:0,urgencyMultiplier:1,subtotal:0,vat:0,total:0},uploadedFiles:[]},t={form:document.getElementById("bookingForm"),steps:null,progressSteps:null,progressFill:document.getElementById("progressFill"),prevBtn:document.getElementById("prevBtn"),nextBtn:document.getElementById("nextBtn"),submitBtn:document.getElementById("submitBtn"),bookingSuccess:document.getElementById("bookingSuccess"),bookingSummary:document.getElementById("bookingSummary"),newBookingBtn:document.getElementById("newBookingBtn"),quickQuote:document.getElementById("quickQuote"),closeQuote:document.getElementById("closeQuote"),fileUploadArea:document.getElementById("fileUploadArea"),fileInput:document.getElementById("photos"),filePreview:document.getElementById("filePreview")};function n(){t.form&&(function(){const t=document.getElementById("bookingServicesData");if(t)try{e.servicesData=JSON.parse(t.textContent)}catch(e){console.error("Error parsing booking services data:",e)}}(),function(){const n=sessionStorage.getItem("bookingProgress");if(n)try{const o=JSON.parse(n);Object.keys(o).forEach(e=>{if("currentStep"===e||"pricing"===e)return;const n=t.form.elements[e];if(n)if("radio"===n.type){const n=t.form.querySelector(`input[name="${e}"][value="${o[e]}"]`);n&&(n.checked=!0)}else"checkbox"===n.type?n.checked="on"===o[e]:n.value=o[e]}),o.currentStep&&(e.currentStep=o.currentStep),o.pricing&&(e.pricing=o.pricing),m()}catch(e){console.error("Error loading saved progress:",e)}}(),t.steps=Array.from(document.querySelectorAll(".wizard-step")),t.progressSteps=Array.from(document.querySelectorAll(".progress-step")),function(){t.prevBtn&&t.prevBtn.addEventListener("click",l),t.nextBtn&&t.nextBtn.addEventListener("click",c),t.submitBtn&&t.submitBtn.addEventListener("click",g),t.newBookingBtn&&t.newBookingBtn.addEventListener("click",p),document.querySelectorAll('input[name="service_id"]').forEach(e=>{e.addEventListener("change",o)});const e=document.getElementById("estimated_duration");e&&e.addEventListener("change",i);const n=document.getElementById("urgency");n&&n.addEventListener("change",r),t.form.addEventListener("input",function(e){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),e(...n)},500)}}(y)),t.closeQuote&&t.closeQuote.addEventListener("click",()=>{t.quickQuote.classList.remove("active")}),t.form.addEventListener("submit",e=>{e.preventDefault(),g()}),t.fileInput&&t.fileInput.addEventListener("change",f)}(),m(),t.fileUploadArea&&(t.fileUploadArea.addEventListener("dragover",e=>{e.preventDefault(),t.fileUploadArea.classList.add("drag-over")}),t.fileUploadArea.addEventListener("dragleave",()=>{t.fileUploadArea.classList.remove("drag-over")}),t.fileUploadArea.addEventListener("drop",e=>{e.preventDefault(),t.fileUploadArea.classList.remove("drag-over"),v(e.dataTransfer.files)})))}function o(t){const n=t.target;e.pricing.basePrice=parseFloat(n.dataset.basePrice)||0,e.pricing.hourlyRate=parseFloat(n.dataset.hourlyPrice)||0,e.formData.serviceName=n.dataset.name,i(),a(),"function"==typeof trackEvent&&trackEvent("booking_service_selected",{service_id:n.value,service_name:e.formData.serviceName})}function r(t){switch(t.target.value){case"priority":e.pricing.urgencyMultiplier=1.25;break;case"emergency":e.pricing.urgencyMultiplier=1.5;break;default:e.pricing.urgencyMultiplier=1}i(),a()}function i(){const t=parseFloat(document.getElementById("estimated_duration")?.value)||0;e.pricing.duration=t;const n=e.pricing.basePrice+e.pricing.hourlyRate*t,o=n*(e.pricing.urgencyMultiplier-1);e.pricing.subtotal=n+o,e.pricing.vat=.05*e.pricing.subtotal,e.pricing.total=e.pricing.subtotal+e.pricing.vat,function(){const t=document.getElementById("basePrice"),n=document.getElementById("hourlyCharge"),o=document.getElementById("urgencyCharge"),r=document.getElementById("urgencyChargeItem"),i=document.getElementById("subtotal"),a=document.getElementById("vatAmount"),c=document.getElementById("totalPrice");if(t&&(t.textContent=`AED ${s(e.pricing.basePrice)}`),n){const t=e.pricing.hourlyRate*e.pricing.duration;n.textContent=`AED ${s(t)}`}if(e.pricing.urgencyMultiplier>1){const t=(e.pricing.basePrice+e.pricing.hourlyRate*e.pricing.duration)*(e.pricing.urgencyMultiplier-1);o&&(o.textContent=`AED ${s(t)}`),r&&(r.style.display="flex")}else r&&(r.style.display="none");i&&(i.textContent=`AED ${s(e.pricing.subtotal)}`),a&&(a.textContent=`AED ${s(e.pricing.vat)}`),c&&(c.textContent=`AED ${s(e.pricing.total)}`)}(),a()}function a(){const n=document.getElementById("quoteService"),o=document.getElementById("quoteDuration"),r=document.getElementById("quoteUrgency"),i=document.getElementById("quoteTotal");n&&e.formData.serviceName&&(n.textContent=e.formData.serviceName),o&&e.pricing.duration>0&&(o.textContent=`${e.pricing.duration} hour${e.pricing.duration>1?"s":""}`);const a=document.getElementById("urgency")?.value;if(r&&a){const e={regular:"Regular",priority:"Priority (+25%)",emergency:"Emergency (+50%)"};r.textContent=e[a]||"-"}i&&e.pricing.total>0&&(i.textContent=`AED ${s(e.pricing.total)}`,t.quickQuote.classList.add("active"))}function s(e){return e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}function c(){d()&&e.currentStep<e.totalSteps&&(e.currentStep++,m(),y(),"function"==typeof trackEvent&&trackEvent("booking_step_completed",{step:e.currentStep-1}),6===e.currentStep&&function(){if(!t.bookingSummary)return;const n=new FormData(t.form);let o="";const r=n.get("service_id"),a=(e.servicesData.find(e=>e.id==r),n.get("urgency"));o+=`\n            <div class="summary-section">\n                <h4><i class="fa-solid fa-wrench"></i> ${E("service_details")}</h4>\n                <div class="summary-item">\n                    <span>${E("service")}:</span>\n                    <strong>${e.formData.serviceName||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("urgency")}:</span>\n                    <strong>${b(a||"-")}</strong>\n                </div>\n            </div>\n        `;const s=n.get("booking_date"),c=n.get("booking_time"),l=n.get("estimated_duration");var d;o+=`\n            <div class="summary-section">\n                <h4><i class="fa-solid fa-calendar"></i> ${E("date_time")}</h4>\n                <div class="summary-item">\n                    <span>${E("date")}:</span>\n                    <strong>${d=s,d?new Date(d).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("time")}:</span>\n                    <strong>${c||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("duration")}:</span>\n                    <strong>${l} ${E("hours")}</strong>\n                </div>\n            </div>\n        `;const u=n.get("emirate"),m=n.get("area"),g=n.get("property_type"),p=n.get("address");o+=`\n            <div class="summary-section">\n                <h4><i class="fa-solid fa-map-marker-alt"></i> ${E("location")}</h4>\n                <div class="summary-item">\n                    <span>${E("emirate")}:</span>\n                    <strong>${b(u||"-")}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("area")}:</span>\n                    <strong>${m||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("property_type")}:</span>\n                    <strong>${b(g||"-")}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("address")}:</span>\n                    <strong>${p||"-"}</strong>\n                </div>\n            </div>\n        `;const f=n.get("client_name"),v=n.get("client_email"),y=n.get("client_phone"),h=n.get("contact_method");o+=`\n            <div class="summary-section">\n                <h4><i class="fa-solid fa-user"></i> ${E("contact_information")}</h4>\n                <div class="summary-item">\n                    <span>${E("name")}:</span>\n                    <strong>${f||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("email")}:</span>\n                    <strong>${v||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("phone")}:</span>\n                    <strong>${y||"-"}</strong>\n                </div>\n                <div class="summary-item">\n                    <span>${E("preferred_contact")}:</span>\n                    <strong>${b(h||"-")}</strong>\n                </div>\n            </div>\n        `;const L=n.get("issue_description");L&&(o+=`\n                <div class="summary-section">\n                    <h4><i class="fa-solid fa-clipboard-list"></i> ${E("issue_description")}</h4>\n                    <p class="summary-description">${function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(L)}</p>\n                </div>\n            `),e.uploadedFiles.length>0&&(o+=`\n                <div class="summary-section">\n                    <h4><i class="fa-solid fa-images"></i> ${E("uploaded_photos")}</h4>\n                    <div class="summary-photos">\n                        ${e.uploadedFiles.map(e=>`\n                            <div class="summary-photo">\n                                <img src="${e.preview}" alt="${e.name}">\n                            </div>\n                        `).join("")}\n                    </div>\n                </div>\n            `),t.bookingSummary.innerHTML=o,i()}())}function l(){e.currentStep>1&&(e.currentStep--,m())}function d(){const n=t.steps[e.currentStep-1].querySelectorAll("input[required], select[required], textarea[required]");let o=!0;if(n.forEach(e=>{if(function(e){const t=e.closest(".form-group")||e.closest(".checkbox-label");if(t){const n=t.querySelector(".form-error");n&&(n.textContent="",n.style.display="none"),e.classList.remove("error")}}(e),e.value.trim())if("email"!==e.type||(n=e.value,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)))if("tel"!==e.type||(t=e.value,/^[\+]?[0-9]{10,15}$/.test(t.replace(/[\s\-]/g,"")))){if("date"===e.type){const t=new Date(e.value),n=new Date;n.setHours(0,0,0,0),t<n&&(u(e,E("invalid_date_past")),o=!1)}}else u(e,E("invalid_phone")),o=!1;else u(e,E("invalid_email")),o=!1;else u(e,E("field_required")),o=!1;var t,n}),1===e.currentStep&&(document.querySelector('input[name="service_id"]:checked')||(L(E("please_select_service"),"error"),o=!1)),6===e.currentStep){const e=document.getElementById("terms_accepted");e&&!e.checked&&(u(e,E("must_accept_terms")),o=!1)}return o}function u(e,t){const n=e.closest(".form-group")||e.closest(".checkbox-label");if(n){const o=n.querySelector(".form-error");o&&(o.textContent=t,o.style.display="block"),e.classList.add("error")}}function m(){t.steps.forEach((t,n)=>{n+1===e.currentStep?(t.classList.add("active"),t.style.display="block"):(t.classList.remove("active"),t.style.display="none")}),t.progressSteps.forEach((t,n)=>{n+1<e.currentStep?(t.classList.add("completed"),t.classList.remove("active")):n+1===e.currentStep?(t.classList.add("active"),t.classList.remove("completed")):t.classList.remove("active","completed")});const n=(e.currentStep-1)/(e.totalSteps-1)*100;t.progressFill&&(t.progressFill.style.width=`${n}%`),t.prevBtn&&(1===e.currentStep?t.prevBtn.style.display="none":t.prevBtn.style.display="inline-flex"),t.nextBtn&&(e.currentStep===e.totalSteps?t.nextBtn.style.display="none":t.nextBtn.style.display="inline-flex"),t.submitBtn&&(e.currentStep===e.totalSteps?t.submitBtn.style.display="inline-flex":t.submitBtn.style.display="none");const o=document.getElementById("booking");if(o){const e=100,t=o.getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"})}}async function g(){if(!d())return;const n=new FormData(t.form);e.uploadedFiles.forEach((e,t)=>{n.append(`photos[${t}]`,e.file)}),n.append("total_price",e.pricing.total),n.append("vat_amount",e.pricing.vat),n.append("subtotal",e.pricing.subtotal),t.submitBtn.disabled=!0,t.submitBtn.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> <span>'+E("submitting")+"...</span>";try{const r=await fetch((o="handlers/booking-handler.php",window.SITE_URL?window.SITE_URL+"/"+o:o),{method:"POST",body:n}),i=await r.json();if(!i.success)throw new Error(i.message||"Booking submission failed");!function(e){t.form.style.display="none",t.bookingSuccess.style.display="block";const n=document.getElementById("bookingReference");n&&(n.textContent=e),t.bookingSuccess.scrollIntoView({behavior:"smooth",block:"center"})}(i.booking_reference),h(),"function"==typeof trackEvent&&trackEvent("booking_submitted",{booking_reference:i.booking_reference,service_id:n.get("service_id"),total_price:e.pricing.total})}catch(e){console.error("Booking submission error:",e),L(e.message||E("booking_error"),"error"),t.submitBtn.disabled=!1,t.submitBtn.innerHTML='<i class="fa-solid fa-paper-plane"></i> <span>'+E("submit_booking")+"</span>"}var o}function p(){e.currentStep=1,e.formData={},e.pricing={basePrice:0,hourlyRate:0,duration:0,urgencyMultiplier:1,subtotal:0,vat:0,total:0},e.uploadedFiles=[],t.form.reset(),t.filePreview&&(t.filePreview.innerHTML=""),t.bookingSuccess.style.display="none",t.form.style.display="block",m(),h();const n=document.getElementById("booking");n&&n.scrollIntoView({behavior:"smooth"})}function f(e){v(e.target.files)}function v(n){const o=["image/jpeg","image/png","image/webp"];Array.from(n).forEach(n=>{if(e.uploadedFiles.length>=5)return void L(E("max_files_exceeded"),"warning");if(n.size>5242880)return void L(`${n.name}: ${E("file_too_large")}`,"warning");if(!o.includes(n.type))return void L(`${n.name}: ${E("invalid_file_type")}`,"warning");const r=new FileReader;r.onload=o=>{const r={file:n,name:n.name,preview:o.target.result};e.uploadedFiles.push(r),function(n){if(!t.filePreview)return;const o=document.createElement("div");o.className="file-preview-item",o.innerHTML=`\n            <img src="${n.preview}" alt="${n.name}">\n            <div class="file-info">\n                <span class="file-name">${n.name}</span>\n            </div>\n            <button type="button" class="remove-file" data-name="${n.name}">\n                <i class="fa-solid fa-times"></i>\n            </button>\n        `,o.querySelector(".remove-file").addEventListener("click",()=>{var t;t=n.name,e.uploadedFiles=e.uploadedFiles.filter(e=>e.name!==t),o.remove()}),t.filePreview.appendChild(o)}(r)},r.readAsDataURL(n)})}function y(){const n=new FormData(t.form),o={};for(let[e,t]of n.entries())o[e]=t;o.currentStep=e.currentStep,o.pricing=e.pricing,sessionStorage.setItem("bookingProgress",JSON.stringify(o))}function h(){sessionStorage.removeItem("bookingProgress")}function b(e){return e?e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," "):""}function E(e){return e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function L(e,t="info"){"function"==typeof window.showNotification?window.showNotification(e,t):alert(e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.BookingModule={nextStep:c,previousStep:l,resetForm:p,calculatePrice:i}}();
//# sourceMappingURL=app.min.js.map